"use strict";function t(t,e,r,a,n,i,o){try{var s=t[i](o),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(a,n)}function e(e){return function(){var r=this,a=arguments;return new Promise(function(n,i){function o(e){t(c,n,i,o,s,"next",e)}function s(e){t(c,n,i,o,s,"throw",e)}var c=e.apply(r,a);o(void 0)})}}function r(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}Component({data:{ctrl:{}},properties:{childs:Array,opts:Array},attached:function(){this.triggerEvent("add",this,{bubbles:!0,composed:!0})},methods:{copyCode:function(t){wx.showActionSheet({itemList:["复制代码"],success:function(){return wx.setClipboardData({data:t.currentTarget.dataset.content})}})},noop:function(){},getNode:function(t){for(var e=t.split("_"),r=this.data.childs[e[0]],a=1;a<e.length;a++)r=r.children[e[a]];return r},play:function(t){if(this.root.data.pauseVideo){for(var e=!1,r=t.target.id,a=this.root._videos.length;a--;)this.root._videos[a].id===r?e=!0:this.root._videos[a].pause();if(!e){var n=wx.createVideoContext(r,this);n.id=r,this.root._videos.push(n)}}},imgTap:function(t){var e=this.getNode(t.target.dataset.i);if(e.a)return this.linkTap(e.a);if(!e.attrs.ignore&&(this.root.triggerEvent("imgtap",e.attrs),this.root.data.previewImg)){var r=this.root.imgList[e.i];wx.previewImage({current:r,urls:this.root.imgList})}},imgLoad:function(t){var e,a=t.target.dataset.i,n=this.getNode(a);n.w?(this.data.opts[1]&&!this.data.ctrl[a]||-1===this.data.ctrl[a])&&(e=1):e=t.detail.width,e&&this.setData(r({},"ctrl."+a,e))},linkTap:function(t){var e=t.currentTarget?this.getNode(t.currentTarget.dataset.i):{},r=e.attrs||t,a=r.href;this.root.triggerEvent("linktap",Object.assign({innerText:this.root.getText(e.children||[])},r)),a&&("#"===a[0]?this.root.navigateTo(a.substring(1)).catch(function(){}):a.includes("://")?this.root.data.copyLink&&wx.setClipboardData({data:a,success:function(){return wx.showToast({title:"链接已复制"})}}):wx.navigateTo({url:a,fail:function(){wx.switchTab({url:a,fail:function(){}})}}))},mediaError:function(t){var e=t.target.dataset.i,a=this.getNode(e);if("video"===a.name||"audio"===a.name){var n=(this.data.ctrl[e]||0)+1;if(n>a.src.length&&(n=0),n<a.src.length)return this.setData(r({},"ctrl."+e,n))}else"img"===a.name&&this.data.opts[2]&&this.setData(r({},"ctrl."+e,-1));this.root&&this.root.triggerEvent("error",{source:a.name,attrs:a.attrs,errMsg:t.detail.errMsg})},previewImage:function(t){var e=t.currentTarget.dataset.imgallsrc,r=t.currentTarget.dataset.imgsrc;wx.previewImage({current:r,urls:e})},goTo:function(t){var e=t.currentTarget.dataset.appid,r=t.currentTarget.dataset.redirectype,a=t.currentTarget.dataset.path,n=t.currentTarget.dataset.url,i=t.currentTarget.dataset.jumptype;"apppage"==r?wx.navigateTo({url:a}):"webpage"==r?(n="../webview/webview?url="+n,wx.navigateTo({url:n})):"miniapp"==r&&("embedded"==i?wx.openEmbeddedMiniProgram({appId:e,path:a}):wx.navigateToMiniProgram({appId:e,path:a}))},goChannels:function(t){var e=t.currentTarget.dataset.channelsid;wx.openChannelsUserProfile({finderUserName:e})},openActivity:function(t){var e=t.currentTarget.dataset.channelsid,r=t.currentTarget.dataset.feedid;wx.openChannelsActivity({finderUserName:e,feedId:r})},openEvent:function(t){var e=t.currentTarget.dataset.channelsid,r=t.currentTarget.dataset.eventid;wx.openChannelsEvent({finderUserName:e,eventId:r})},goToSinshopproduct:function(t){var e=t.currentTarget.dataset.path;wx.navigateTo({url:e})},openmap:function(t){var e=Number(t.currentTarget.dataset.latitude),r=Number(t.currentTarget.dataset.longitude),a=t.currentTarget.dataset.address,n=t.currentTarget.dataset.title;wx.openLocation({latitude:e,longitude:r,scale:15,name:n,address:a})},onTapATag:function(t){var e=t.currentTarget.dataset.src,r=t.currentTarget.dataset.appid,a=t.currentTarget.dataset.redirectype,n=t.currentTarget.dataset.path;if(/\.(doc|docx|xls|xlsx|ppt|pptx|pdf)$/.test(e))return void this.openLinkDoc(t);a?"apppage"==a?wx.navigateTo({url:n}):"webpage"==a?(e="../webview/webview?url="+e,wx.navigateTo({url:e})):"miniapp"==a&&wx.navigateToMiniProgram({appId:r,path:n}):wx.setClipboardData({data:e,success:function(){return wx.showToast({title:"链接已复制"})}})},onbaiPanCopy:function(t){var e=t.currentTarget.dataset.code;if(!e)return void wx.showToast({title:"提取码不存在！",icon:"none",duration:3e3});wx.setClipboardData({data:e,success:function(t){wx.getClipboardData({success:function(t){wx.showToast({title:"复制成功",icon:"success",duration:3e3})}})}})},onbaiduPanOpen:function(t){var e=t.currentTarget.dataset.key;if(e){var r="pages/netdisk_share/share?scene=".concat(e);wx.navigateToMiniProgram({appId:"wxdcd3d073e47d1742",path:r})}else wx.showToast({title:"链接不存在！",icon:"none",duration:3e3})},openLinkDoc:function(t){return e(regeneratorRuntime.mark(function e(){var r,a,n,i,o,s,c,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.currentTarget.dataset.src||"",e.next=3,getApp().$api.getBaseConfig();case 3:if(i=e.sent,console.log("domains"),console.log(i),o=i.settings||{},s=o.downloadfile_domain&&o.downloadfile_domain.split(",")||[],c=s.find(function(t){return n.includes(t)})){e.next=12;break}return wx.setClipboardData({data:n,success:function(){return wx.showToast({title:"链接已复制"})}}),e.abrupt("return");case 12:d=/\.(doc|docx|xls|xlsx|ppt|pptx|pdf)$/.test(n),n&&d?(r=n,a=/doc|docx|xls|xlsx|ppt|pptx|pdf$/.exec(n)[0]):(r=t.currentTarget.dataset.filelink,a=t.currentTarget.dataset.filetype),wx.downloadFile({url:r,success:function(t){var e=t.tempFilePath;wx.openDocument({filePath:e})}});case 15:case"end":return e.stop()}},e)}))()}}});